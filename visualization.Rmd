---
title: "visualization"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))

library(Rgraphviz)
library(ini)
```

```{r}
# Read config file
config <- read.ini('./Configs/breast_cancer_top30miRNAs.ini')

load(file=config$output$miRNAgroups)
load(file=config$output$epigroups)
load(file=config$output$mesgroups)
groupDAG <- readRDS(config$output$group_dag)

nAttrs <- list(
  fillcolor = c(
    '1' = '#e17055',
    '2' = '#e17055',
    '3' = '#e17055',
    '4' = '#e17055',
    '5' = '#e17055',
    '6' = '#00cec9',
    '7' = '#00cec9',
    '8' = '#00cec9',
    '9' = '#00cec9',
    '10' = '#00cec9',
    '11' = '#0984e3',
    '12' = '#0984e3',
    '13' = '#0984e3',
    '14' = '#0984e3',
    '15' = '#0984e3'
  ),
  color = c(
    '1' = 'white',
    '2' = 'white',
    '3' = 'white',
    '4' = 'white',
    '5' = 'white',
    '6' = 'white',
    '7' = 'white',
    '8' = 'white',
    '9' = 'white',
    '10' = 'white',
    '11' = 'white',
    '12' = 'white',
    '13' = 'white',
    '14' = 'white',
    '15' = 'white'
  ),
  fontcolor =  c(
    '1' = '',
    '2' = '#2d3436',
    '3' = '#2d3436',
    '4' = '#2d3436',
    '5' = '#2d3436',
    '6' = '#2d3436',
    '7' = '#2d3436',
    '8' = '#2d3436',
    '9' = '#2d3436',
    '10' = '#2d3436',
    '11' = '#2d3436',
    '12' = '#2d3436',
    '13' = '#2d3436',
    '14' = '#2d3436',
    '15' = '#2d3436'
  )
)

edgeAttrs <- list(
  color = list(
    '2~6' = '#eb4d4b',
    '2~8' = '#eb4d4b',
    '2~9' = '#eb4d4b',
    '4~6' = '#eb4d4b',
    '4~7' = '#eb4d4b',
    '4~8' = '#eb4d4b',
    '5~7' = '#eb4d4b',
    '7~12' = '#e056fd',
    '7~15' = '#e056fd',
    '9~12' = '#e056fd'
  )
)

plot(groupDAG@graph, attrs=list(
  edge=list(color='black')
), nodeAttrs=nAttrs, edgeAttrs=edgeAttrs)
```

```{r}
# Read config file
config <- read.ini('./Configs/breast_cancer_EMTmarkers.ini')

load(file=config$output$epiMarkersGroups)
load(file=config$output$mesMarkersGroups)
load(file=config$output$bothMarkersGroups)

groupDAG <- readRDS(config$output$epiMarkersGroupDag)

nAttrs <- list(
  fillcolor = c(
    '1' = '#e17055',
    '2' = '#e17055',
    '3' = '#e17055',
    '4' = '#e17055',
    '5' = '#e17055',
    '6' = '#e17055',
    '7' = '#00cec9',
    '8' = '#00cec9',
    '9' = '#00cec9',
    '10' = '#00cec9',
    '11' = '#00cec9',
    '12' = '#0984e3',
    '13' = '#0984e3',
    '14' = '#0984e3',
    '15' = '#0984e3',
    '16' = '#0984e3'
  ),
  color = c(
    '1' = 'white',
    '2' = 'white',
    '3' = 'white',
    '4' = 'white',
    '5' = 'white',
    '6' = 'white',
    '7' = 'white',
    '8' = 'white',
    '9' = 'white',
    '10' = 'white',
    '11' = 'white',
    '12' = 'white',
    '13' = 'white',
    '14' = 'white',
    '15' = 'white',
    '16' = 'white'
  ),
  fontcolor =  c(
    '1' = '',
    '2' = '#2d3436',
    '3' = '#2d3436',
    '4' = '#2d3436',
    '5' = '#2d3436',
    '6' = '#2d3436',
    '7' = '#2d3436',
    '8' = '#2d3436',
    '9' = '#2d3436',
    '10' = '#2d3436',
    '11' = '#2d3436',
    '12' = '#2d3436',
    '13' = '#2d3436',
    '14' = '#2d3436',
    '15' = '#2d3436',
    '16' = '#2d3436'
  )
)

edgeAttrs <- list(
  color = list(
    '5~10' = '#eb4d4b',
    '7~16' = '#e056fd',
    '8~12' = '#e056fd',
    '8~13' = '#e056fd',
    '8~16' = '#e056fd',
    '9~16' = '#e056fd',
    '11~16' = '#e056fd'
  )
)

plot(groupDAG@graph, attrs=list(
  edge=list(color='black')
), nodeAttrs=nAttrs, edgeAttrs=edgeAttrs)
```

```{r}
groupDAG <- readRDS(config$output$mesMarkersGroupDag)

nAttrs <- list(
  fillcolor = c(
    '1' = '#e17055',
    '2' = '#e17055',
    '3' = '#e17055',
    '4' = '#00cec9',
    '5' = '#00cec9',
    '6' = '#00cec9',
    '7' = '#00cec9',
    '8' = '#00cec9',
    '9' = '#0984e3',
    '10' = '#0984e3',
    '11' = '#0984e3',
    '12' = '#0984e3',
    '13' = '#0984e3'
  ),
  color = c(
    '1' = 'white',
    '2' = 'white',
    '3' = 'white',
    '4' = 'white',
    '5' = 'white',
    '6' = 'white',
    '7' = 'white',
    '8' = 'white',
    '9' = 'white',
    '10' = 'white',
    '11' = 'white',
    '12' = 'white',
    '13' = 'white'
  ),
  fontcolor =  c(
    '1' = '',
    '2' = '#2d3436',
    '3' = '#2d3436',
    '4' = '#2d3436',
    '5' = '#2d3436',
    '6' = '#2d3436',
    '7' = '#2d3436',
    '8' = '#2d3436',
    '9' = '#2d3436',
    '10' = '#2d3436',
    '11' = '#2d3436',
    '12' = '#2d3436',
    '13' = '#2d3436'
  )
)

edgeAttrs <- list(
  color = list(
    '2~7' = '#eb4d4b',
    '2~11' = '#eb4d4b',
    '2~13' = '#eb4d4b',
    '3~12' = '#eb4d4b',
    '7~16' = '#e056fd',
    '4~11' = '#e056fd',
    '8~12' = '#e056fd'
  )
)

plot(groupDAG@graph, attrs=list(
  edge=list(color='black')
), nodeAttrs=nAttrs, edgeAttrs=edgeAttrs)
```

```{r}
groupDAG <- readRDS(config$output$bothMarkersGroupDag)

nAttrs <- list(
  fillcolor = c(
    '1' = '#e17055',
    '2' = '#e17055',
    '3' = '#00cec9',
    '4' = '#00cec9',
    '5' = '#00cec9',
    '6' = '#00cec9',
    '7' = '#00cec9',
    '8' = '#0984e3',
    '9' = '#0984e3',
    '10' = '#0984e3',
    '11' = '#0984e3',
    '12' = '#0984e3'
  ),
  color = c(
    '1' = 'white',
    '2' = 'white',
    '3' = 'white',
    '4' = 'white',
    '5' = 'white',
    '6' = 'white',
    '7' = 'white',
    '8' = 'white',
    '9' = 'white',
    '10' = 'white',
    '11' = 'white',
    '12' = 'white',
    '13' = 'white'
  ),
  fontcolor =  c(
    '1' = '',
    '2' = '#2d3436',
    '3' = '#2d3436',
    '4' = '#2d3436',
    '5' = '#2d3436',
    '6' = '#2d3436',
    '7' = '#2d3436',
    '8' = '#2d3436',
    '9' = '#2d3436',
    '10' = '#2d3436',
    '11' = '#2d3436',
    '12' = '#2d3436',
    '13' = '#2d3436'
  )
)

edgeAttrs <- list(
  color = list(
    '1~3' = '#eb4d4b',
    '3~8' = '#e056fd',
    '4~8' = '#e056fd',
    '7~10' = '#e056fd'
  )
)

plot(groupDAG@graph, attrs=list(
  edge=list(color='black')
), nodeAttrs=nAttrs, edgeAttrs=edgeAttrs)
```